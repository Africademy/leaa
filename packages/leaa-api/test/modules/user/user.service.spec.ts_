import { Test, TestingModule } from '@nestjs/testing';
import { UserService } from '@leaa/api/modules/user/user.service';
import { User, Role, Permission } from '@leaa/common/entrys';
import { AuthResolver } from '@leaa/api/modules/auth/auth.resolver';
import { AuthService } from '@leaa/api/modules/auth/auth.service';
import { UserResolver } from '@leaa/api/modules/user/user.resolver';
import { RoleService } from '@leaa/api/modules/role/role.service';
import { PermissionService } from '@leaa/api/modules/permission/permission.service';
import { JwtStrategy } from '@leaa/api/strategies';
import { TypeOrmModule } from '@nestjs/typeorm';
import { AuthTokenModule } from '@leaa/api/modules/auth-token/auth-token.module';
import { RoleModule } from '@leaa/api/modules/role/role.module';

describe('UserService', () => {
  let usersService: UserService;

  beforeEach(async () => {
    const module: TestingModule = await Test.createTestingModule({
      // imports: [TypeOrmModule.forFeature([User, Role, Permission]), AuthTokenModule, RoleModule],
      providers: [UserResolver, UserService],
      // exports: [UserService],
    }).compile();

    usersService = module.get<UserService>(UserService);
  });

  it('should be defined', () => {
    expect(usersService).toBeDefined();
  });

  // it('should test user', async () => {
  //   // eslint-disable-next-line max-len
  //   const authToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6NSwiaWF0IjoxNTY0NjUwMDk3LCJleHAiOjE1ODAyMDIwOTd9.6rrQ6qkFWIujvEYvQDye_zxo7Ox4cnDl6Hbns3eyYQI'; // prettier-ignore
  //
  //   const result: any = {
  //     id: 1,
  //     name: 'admin',
  //     authToken,
  //   };
  //
  //   jest.spyOn(usersService, 'user').mockImplementation(() => {
  //     console.log(result);
  //
  //     return result;
  //   });
  //
  //   expect(await usersService.user(1)).toBe(result);
  // });
});
